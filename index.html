<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>üé§ Risottolingo</title>
<style>
  body {
    font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
    max-width: 480px;
    margin: 40px auto;
    padding: 20px;
    background: #f0f4f8;
    color: #333;
    user-select: none;
  }
  h1 {
    text-align: center;
    margin-bottom: 30px;
    font-weight: 700;
    font-size: 2.2rem;
    color: #2563eb;
  }
  #mode-select button {
    width: 100%;
    padding: 14px 0;
    margin: 12px 0;
    border: none;
    border-radius: 10px;
    font-size: 1.15rem;
    font-weight: 600;
    cursor: pointer;
    color: white;
    transition: background-color 0.3s ease;
  }
  #word-mode-btn {
    background-color: #2563eb;
  }
  #word-mode-btn:hover {
    background-color: #1e40af;
  }
  #sentence-mode-btn {
    background-color: #16a34a;
  }
  #sentence-mode-btn:hover {
    background-color: #14532d;
  }
  #game {
    display: none;
    background: white;
    padding: 30px;
    border-radius: 15px;
    box-shadow: 0 12px 30px rgb(0 0 0 / 0.1);
  }
  #prompt {
    font-size: 1.3rem;
    margin-bottom: 15px;
    font-weight: 600;
  }
  #current-part-label {
    font-weight: 600;
    color: #555;
  }
  #current-part {
    font-size: 1.5rem;
    color: #2563eb;
    margin-left: 8px;
  }
  #status {
    margin-top: 20px;
    min-height: 1.3rem;
    font-weight: 600;
    font-size: 1.1rem;
  }
  #speak-btn, #stop-btn {
    display: block;
    margin: 20px auto 0 auto;
    background-color: #7c3aed;
    color: white;
    border: none;
    border-radius: 12px;
    padding: 14px 0;
    width: 100%;
    font-size: 1.2rem;
    cursor: pointer;
    font-weight: 700;
    transition: background-color 0.25s ease;
  }
  #speak-btn:hover:not(:disabled), #stop-btn:hover:not(:disabled) {
    background-color: #5b21b6;
  }
  #speak-btn:disabled, #stop-btn:disabled {
    background-color: #d8b4fe;
    cursor: not-allowed;
  }
  #back-btn {
    margin-top: 30px;
    background: none;
    border: none;
    color: #ef4444;
    cursor: pointer;
    font-weight: 700;
    font-size: 1rem;
    text-decoration: underline;
    display: block;
    margin-left: auto;
  }
  #back-btn:hover {
    color: #b91c1c;
  }
</style>
</head>
<body>

<h1>üé§ Spelling Bee</h1>

<div id="mode-select">
  <button id="word-mode-btn">Word Mode</button>
  <button id="sentence-mode-btn">Sentence Mode</button>
</div>

<div id="game">
  <p id="prompt"></p>
  <p><span id="current-part-label">Current:</span><span id="current-part"></span></p>
  <button id="speak-btn">üéô Start Speaking</button>
  <button id="stop-btn" disabled>üõë Stop Speaking</button>
  <p id="status"></p>
  <button id="back-btn">‚Üê Back to mode selection</button>
</div>

<script>
(() => {
  const words = [
  "apple", "ball", "cat", "dog", "eat", "fast", "good", "house", "ice", "jump",
  "kite", "leg", "mom", "new", "old", "pen", "queen", "run", "sun", "tree",
  "up", "van", "water", "box", "yes", "zoo", "bird", "car", "door", "egg",
  "friend", "girl", "hand", "ice cream", "job", "key", "light", "man", "nose", "orange",
  "park", "quick", "red", "sit", "time", "umbrella", "village", "window", "yellow", "zip",
  "ant", "book", "cake", "day", "ear", "fish", "game", "hat", "island", "juice",
  "king", "lake", "moon", "night", "open", "pig", "queen", "rain", "star", "table",
  "use", "voice", "walk", "x-ray", "yard", "zebra", "air", "boy", "cup", "dance",
  "eye", "family", "go", "hill", "idea", "jump", "kite", "love", "milk", "nose",
  "oil", "pop", "quiet", "rose", "sun", "tree", "under", "very", "warm", "yes",

  "actor", "baby", "cake", "desk", "easy", "fast", "girl", "hope", "iron", "job",
  "kind", "leaf", "moon", "nice", "open", "post", "quiz", "rain", "snow", "time",
  "unit", "view", "wind", "x-ray", "yard", "zero", "animal", "bread", "city", "door",
  "egg", "face", "gold", "hill", "ink", "jar", "king", "lamp", "map", "nest",
  "owl", "pen", "queen", "road", "sun", "tree", "use", "van", "wall", "xylophone",
  "yellow", "zebra", "apple", "ball", "cat", "dog", "eat", "fan", "goat", "hat",
  "ice", "joke", "kite", "log", "man", "net", "oak", "pig", "queen", "rat",
  "sit", "top", "up", "van", "wet", "box", "yak", "zip", "arm", "bat",
  "cow", "dig", "elf", "fog", "gym", "hat", "ill", "jar", "kid", "leg",
  "mud", "nap", "oak", "pit", "quack", "run", "sun", "tip", "urn", "vet",
  "win", "box", "yam", "zigzag", "ant", "bag", "cap", "dip", "ear", "fit",
  "gap", "hit", "ink", "jam", "kid", "lap", "mat", "net", "oak", "pan",
  "quilt", "rip", "sip", "tap", "urn", "van", "wax", "yam", "zip", "axe",

  "balloon", "camera", "doctor", "elephant", "forest", "guitar", "holiday", "island", "jungle", "kitchen",
  "lemon", "mountain", "nature", "ocean", "pencil", "quiet", "river", "school", "teacher", "umbrella",
  "violin", "window", "yellow", "zebra", "animal", "bridge", "castle", "desert", "engine", "family",
  "garden", "hospital", "internet", "jacket", "knowledge", "library", "market", "necklace", "octopus", "planet",
  "queen", "rocket", "sandwich", "turtle", "universe", "volcano", "waterfall", "xylophone", "yogurt", "zoo",
  "apple", "banana", "cherry", "date", "eggplant", "fig", "grape", "honey", "iceberg", "jackfruit",
  "kiwi", "leek", "mango", "nectarine", "olive", "papaya", "quince", "raspberry", "strawberry", "tomato",
  "ugli", "vanilla", "watermelon", "xigua", "yam", "zucchini", "antelope", "buffalo", "cheetah", "dolphin",
  "elephant", "flamingo", "giraffe", "hippopotamus", "iguana", "jaguar", "koala", "lemur", "meerkat", "newt",
  "octopus", "penguin", "quail", "raccoon", "shark", "tiger", "urchin", "vulture", "wolf", "xerus",
  "yak", "zebra", "actor", "ball", "cat", "dog", "egg", "fish", "goat", "hat",
  "ink", "jar", "key", "log", "man", "net", "oak", "pen", "queen", "rat",
  "sun", "top", "up", "van", "wet", "box", "yak", "zip"
];

  const sentences = [
    "The quick brown fox jumps over the lazy dog",
    "She sells seashells by the seashore",
    "How much wood would a woodchuck chuck"
  ];

const phoneticMap = {
  // A
  alpha: "a", adam: "a", a: "a", ay: "a", argentina: "a", australia: "a",
  // B
  bravo: "b", boy: "b", b: "b", bee: "b", belgium: "b",
  // C
  charlie: "c", c: "c", see: "c", canada: "c",
  // D
  delta: "d", david: "d", d: "d", dee: "d", denmark: "d",
  // E
  echo: "e", edward: "e", e: "e", ee: "e", egypt: "e",
  // F
  foxtrot: "f", frank: "f", f: "f", ef: "f", france: "f",
  // G
  golf: "g", george: "g", g: "g", gee: "g", greenland: "g",
  // H
  hotel: "h", henry: "h", h: "h", aitch: "h", hungary: "h",
  // I
  india: "i", ida: "i", i: "i", eye: "i", ireland: "i",
  // J
  juliett: "j", john: "j", j: "j", jay: "j", jamaica: "j",
  // K
  kilo: "k", king: "k", k: "k", kay: "k", kenya: "k",
  // L
  lima: "l", lincoln: "l", l: "l", el: "l", lithuania: "l", luxembourg: "l", latvia: "l",
  // M
  mike: "m", mary: "m", m: "m", em: "m", mexico: "m",
  // N
  november: "n", nora: "n", n: "n", en: "n", netherlands: "n",
  // O
  oscar: "o", o: "o", oh: "o", oman: "o",
  // P
  papa: "p", paul: "p", p: "p", pee: "p", pakistan: "p",
  // Q
  quebec: "q", queen: "q", q: "q", cue: "q", qatar: "q",
  // R
  romeo: "r", robert: "r", r: "r", ar: "r", romania: "r",
  // S
  sierra: "s", sam: "s", s: "s", ess: "s", serbia: "s",
  // T
  tango: "t", tom: "t", t: "t", tee: "t", tunisia: "t",
  // U
  uniform: "u", union: "u", u: "u", you: "u", usa: "u",
  // V
  victor: "v", v: "v", vee: "v", venezuela: "v",
  // W
  whiskey: "w", william: "w", w: "w", doubleyou: "w", "western sahara": "w",
  // X
  xray: "x", x: "x", ex: "x", xavier: "x",
  // Y
  yankee: "y", young: "y", y: "y", why: "y", yemen: "y",
  // Z
  zulu: "z", zebra: "z", z: "z", zee: "z", zed: "z", zambia: "z", zimbabwe: "z"
};



  const modeSelectEl = document.getElementById('mode-select');
  const gameEl = document.getElementById('game');
  const promptEl = document.getElementById('prompt');
  const currentPartEl = document.getElementById('current-part');
  const speakBtn = document.getElementById('speak-btn');
  const stopBtn = document.getElementById('stop-btn');
  const statusEl = document.getElementById('status');
  const backBtn = document.getElementById('back-btn');

  let mode = null;
  let currentItem = "";
  let progress = 0;
  let recognition = null;
  let collectedSpeech = "";

  function chooseRandom(list) {
    return list[Math.floor(Math.random() * list.length)];
  }

  function resetGame(selectedMode) {
    mode = selectedMode;
    progress = 0;
    currentItem = (mode === 'word') ? chooseRandom(words) : chooseRandom(sentences);
    statusEl.textContent = "Say the next " + (mode === 'word' ? "letter" : "word") + ".";
    promptEl.textContent = mode === 'word' ? `Spell this word: ${currentItem}` : `Say this sentence: "${currentItem}"`;
    updateCurrentPart();
    modeSelectEl.style.display = 'none';
    gameEl.style.display = 'block';
    speakBtn.disabled = false;
    stopBtn.disabled = true;
    collectedSpeech = "";
  }

  function updateCurrentPart() {
    if (mode === 'word') {
      currentPartEl.textContent = currentItem[progress] || "";
    } else {
      const wordsInSentence = currentItem.split(' ');
      currentPartEl.textContent = wordsInSentence[progress] || "";
    }
  }

  function startRecognition() {
    if (!('webkitSpeechRecognition' in window || 'SpeechRecognition' in window)) {
      alert("Your browser does not support Speech Recognition.");
      return;
    }

    recognition = new (window.SpeechRecognition || window.webkitSpeechRecognition)();
    recognition.lang = 'en-US';
    recognition.interimResults = true;
    recognition.continuous = true;

    recognition.onstart = () => {
      speakBtn.disabled = true;
      stopBtn.disabled = false;
      statusEl.textContent = "üé§ Listening...";
      collectedSpeech = "";
    };

    recognition.onresult = (event) => {
      const results = event.results;
      let interim = "";
      for (let i = event.resultIndex; i < results.length; ++i) {
        const transcript = results[i][0].transcript.trim();
        if (results[i].isFinal) {
          collectedSpeech += " " + transcript;
        } else {
          interim += transcript + " ";
        }
      }
      statusEl.textContent = `üó£Ô∏è ${interim.trim()}`;
    };

    recognition.onerror = (event) => {
      statusEl.textContent = "Error occurred: " + event.error;
      speakBtn.disabled = false;
      stopBtn.disabled = true;
    };

    recognition.start();
  }

  function stopRecognition() {
  if (recognition) {
    recognition.stop();
    stopBtn.disabled = true;
    speakBtn.disabled = false;

    // Eƒüer collectedSpeech bo≈üsa interimResults'ƒ± dene
    let spoken = collectedSpeech.trim().toLowerCase();

    if (!spoken && statusEl.textContent.startsWith("üó£Ô∏è")) {
      spoken = statusEl.textContent.replace("üó£Ô∏è", "").trim().toLowerCase();
    }

    if (!spoken) {
      statusEl.textContent = "‚ùå Nothing was understood. Try again.";
      return;
    }

    handleSpeech(spoken);
  }
}


  function phoneticToChar(input) {
    if (phoneticMap[input]) return phoneticMap[input];
    if (input.length === 1 && /^[a-z]$/.test(input)) return input;
    return null;
  }

  function handleSpeech(spoken) {
    if (!spoken) {
      statusEl.textContent = "‚ùå No input detected.";
      return;
    }

    if (mode === 'word') {
      const spokenParts = spoken.split(/\s+/);
      for (let i = 0; i < spokenParts.length; i++) {
        const s = spokenParts[i];
        const mapped = phoneticToChar(s);
        if (!mapped) continue;
        const expected = currentItem[progress].toLowerCase();
        if (mapped === expected) {
          progress++;
          if (progress === currentItem.length) {
            statusEl.textContent = "‚úÖ Well done! Moving to next word...";
            setTimeout(() => resetGame(mode), 1500);
            return;
          } else {
            statusEl.textContent = `Correct! ${progress} / ${currentItem.length}`;
            updateCurrentPart();
            return;
          }
        } else {
          statusEl.textContent = `‚ùå Expected "${expected}" but got "${mapped}". Try again.`;
          updateCurrentPart();
          return;
        }
      }
    } else if (mode === 'sentence') {
      const wordsInSentence = currentItem.toLowerCase().split(' ');
      const spokenWords = spoken.split(/\s+/);
      for (let i = 0; i < spokenWords.length; i++) {
        const expected = wordsInSentence[progress];
        if (spokenWords[i] === expected) {
          progress++;
          if (progress === wordsInSentence.length) {
            statusEl.textContent = "‚úÖ Sentence complete! New one coming up...";
            setTimeout(() => resetGame(mode), 1500);
            return;
          } else {
            statusEl.textContent = `Good! ${progress} / ${wordsInSentence.length}`;
            updateCurrentPart();
            return;
          }
        } else {
          statusEl.textContent = `‚ùå Wrong word. Expected "${expected}" but got "${spokenWords[i]}"`;
          updateCurrentPart();
          return;
        }
      }
    }
  }

  document.getElementById('word-mode-btn').addEventListener('click', () => resetGame('word'));
  document.getElementById('sentence-mode-btn').addEventListener('click', () => resetGame('sentence'));
  speakBtn.addEventListener('click', startRecognition);
  stopBtn.addEventListener('click', stopRecognition);
  backBtn.addEventListener('click', () => {
    modeSelectEl.style.display = 'block';
    gameEl.style.display = 'none';
    statusEl.textContent = "";
    progress = 0;
    currentItem = "";
    collectedSpeech = "";
    if (recognition) recognition.stop();
  });
})();
</script>


</body>
</html>
